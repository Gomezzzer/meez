<!DOCTYPE html>
<html>
<head>
  <title>Meez</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <!-- Add this line within the <head> section of your HTML file -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
 
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  <style>
  .btn-blueviolet {
    background-color: blueviolet;
    border-color: blueviolet;
    color: white; /* Change text color to white for better contrast */
  }

  .btn-blueviolet:hover {
    background-color: darkviolet;
    border-color: darkviolet;
  }
</style>

</head>

<body id="recipe_mod">
  <div class="container mt-4 mb-3">
    <h1>Recipe modifiers</h1>
    <div class="row"> 
      <% @recipe_modifiers.each do |recipe_modifier| %>
        <div class="col-md-6 mb-5">
          <div class="card-wrapper">
            <div class="shadow p-3 bg-body-tertiary rounded w-100">
              <div class="card-header">
                <strong>Name:</strong> <%= recipe_modifier.name %>
              </div>
              <div class="card-body">
                <h5 class="card-title"><strong>Description:</strong> <%= recipe_modifier.description %></h5>
                <p class="card-text"><strong>Measurements:</strong></p>
                <!-- Display recipe measurements in a list -->
                <ul class="list-group">
                  <% recipe_modifier.measurements.split('/').each do |measurement| %>
                    <li class="list-group-item"><%= measurement.strip %></li>
                  <% end %>
                </ul>
              </div>
              <div class="card-footer">
               <!-- Button trigger modal -->
                <button type="button" class="btn btn-blueviolet adjust-yield-btn" data-bs-toggle="modal" data-bs-target="#exampleModal<%= recipe_modifier.id %>">
                  Adjust Yield
                </button>
              </div>
            </div>
          </div>
          <p><%= link_to "Show this recipe modifier", recipe_modifier %></p>
        </div>
        
 
      
    <!-- Modal -->
    <div class="modal fade" id="exampleModal<%= recipe_modifier.id %>" tabindex="-1" aria-labelledby="exampleModalLabel<%= recipe_modifier.id %>" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header bg-info">
            <h5 class="modal-title" id="exampleModalLabel<%= recipe_modifier.id %>">Adjust Yield</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <!-- Additional input fields for scaling -->
            <div class="mb-3">
              <label for="scaleFactorInput">Scale Factor:</label>
              <input type="number" class="form-control" id="scaleFactorInput" placeholder="Enter scale factor" min="0" step="1">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <!-- Move the link button to the footer -->
            <%= link_to 'Desired Yield Page', desired_yield_page_recipe_modifiers_path(recipe_modifier_id: recipe_modifier.id, scaleFactor: @scaling_factor), class: 'btn btn-primary' %>
          </div>
        </div>
      </div>
    </div>
 <% end %>


  <div class="m-2"> 
    <%= link_to "New recipe modifier", new_recipe_modifier_path %>
  </div>

<!-- Connect this JavaScript -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


<script>
// Function to handle desired yield page button click
  $(document).ready(function() {
    $('.btn-primary').on('click', function(e) {
      e.preventDefault(); // Prevent default link behavior

      // Find the closest modal to the clicked button
      var modal = $(this).closest('.modal');

      // Extract recipe modifier ID from modal's ID attribute
      var recipeModifierId = modal.attr('id').replace('exampleModal', '');

      // Retrieve scale factor input value within the modal
      var scaleFactor = parseFloat(modal.find('#scaleFactorInput').val());

      // Validate scale factor input
      if (isNaN(scaleFactor) || scaleFactor <= 0) {
        alert('Please enter a valid scale factor.');
        return;
      }

      // Redirect to the desired yield page with the scale factor and recipe modifier ID as query parameters
      window.location.href = '<%= url_for(controller: 'recipe_modifiers', action: 'desired_yield_page') %>?recipe_modifier_id=' + recipeModifierId + '&scaleFactor=' + encodeURIComponent(scaleFactor);
    });
  });
</script>





  
</body>
</html>











 
